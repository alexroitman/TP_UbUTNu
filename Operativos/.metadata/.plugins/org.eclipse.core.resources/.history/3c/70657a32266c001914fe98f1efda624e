#include "comunicacion.h"

int serializarRequest(t_Package_Request packageRequest, tPaquete* paqueteSerializado){

	paqueteSerializado = malloc(sizeof(package));

	int offset = 0;
	int size_to_send;

	size_to_send =  strlen(packageRequest.header)+1;
	memcpy(paqueteSerializado->payload + offset, packageRequest.header, size_to_send);
	offset += size_to_send;

	size_to_send =  strlen(packageRequest.query)+1;
	memcpy(paqueteSerializado->payload + offset, packageRequest.query, size_to_send);
	paqueteSerializado->length = offset + size_to_send;

	return paqueteSerializado;
}

int desSerializarRequest(tPaquete paqueteSerializado, t_Package_Request* packageRequest){
	packageRequest = malloc(strlen(paqueteSerializado)*sizeof(char));
	int offset=0;
	int size_to_send;

	for(size_to_send=1;(paqueteSerializado+offset)[size_to_send-1]!= '\0';size_to_send++);
	packageRequest->header=malloc(size_to_send);
	memcpy(packageRequest->header,paqueteSerializado+offset,size_to_send);
	offset+=size_to_send;
	for(size_to_send=1;(paqueteSerializado+offset)[size_to_send-1]!= '\0';size_to_send++);
	packageRequest->query=malloc(size_to_send);
	memcpy(packageRequest->query,paqueteSerializado+offset,size_to_send);

	return packageRequest;
}
